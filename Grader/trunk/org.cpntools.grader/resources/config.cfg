[matcher]
-0.5: signature,threshold=50

[tests]
-50.0: declaration-preservation,globref
-50.0: interface-preservation,addpages=false,initmark=true,subset=deliveryservice
1.0: btl,repeats=5,name="Accept 10 Orders",test=
	+ (attempts := "3") &
	+ (capacity := "5") &
	+ (10 * (--> System.Customer.Order) -> (--> System.Customer.Order) => failure) &
	+ (@(!System.Customer.reject)) &
	+ (true ---> [|System.Customer.Received_Packages| = 10 & |System.Shop.Returns| = 0]) &
	+ (10 * (--> System.Shop.Finish_Order))
1.0: btl,repeats=5,name="Reject 10 Orders",test=
	+ (attempts := "3") &
	+ (capacity := "5") &
	+ (System.Order := "10`(\"Bob\",A,\"Book\")") &
	+ (@(!System.Customer.order & !System.Customer.accept)) &
	+ ((--> System.Shop.Finish_Order) => false) &
	+ (true ---> [|System.Shop.Returns| = 10 & |System.Customer.Received_Packages| = 0])
1.0: btl,repeats=5,name="30 Random Orders",test=
	+ (attempts := "3") &
	+ (capacity := "5") &
	+ (30 * (--> System.Customer.Order) -> (--> System.Customer.Order) => failure) &
	+ (true ---> [|System.Customer.Received_Packages| + |System.Shop.Returns| = 30])
1.0: btl,repeats=5,name="3 Rejects lead to Return (for 10 packages)",test=
	+ (attempts := "3") &
	+ (capacity := "5") &
	+ (System.Order := "10`(\"Bob\",A,\"Book\")") &
	+ (@(!System.Customer.order & !System.Customer.accept)) &
	+ [10 * ((((((* !System.Customer.Reject -> System.Customer.Reject) -> * !System.Customer.Reject) -> System.Customer.Reject) -> * !System.Customer.Reject) -> System.Customer.Reject) -> * (!System.Customer.Reject & !System.Customer.Accept))] &
	+ [(--> System.Customer.Receive) => false] &
	+ ((10 * (--> System.Shop.Handle_Return)) -> (--> System.Shop.Handle_Return) => failure)
1.0: btl,anti,repeats=5,name="4 Rejects impossible (negative score when 4 Rejects)",test=
	+ (attempts := "3") &
	+ (capacity := "5") &
	+ (System.Order := "10`(\"Bob\",A,\"Book\")") &
	+ (@(!System.Customer.order & !System.Customer.accept)) &
	+ [10 * ((((((((* !System.Customer.Reject -> System.Customer.Reject) -> * !System.Customer.Reject) -> System.Customer.Reject) -> * !System.Customer.Reject) -> System.Customer.Reject) -> * !System.Customer.Reject) -> System.Customer.Reject) -> * (!System.Customer.Reject & !System.Customer.Accept))] &
	+ [(--> System.Customer.Receive) => false] &
	+ ((10 * (--> System.Shop.Handle_Return)) -> (--> System.Shop.Handle_Return) => failure)
1.0: btl,repeats=5,name="Packet to Depot after Reject",test=
	+ (attempts := "3") &
	+ (capacity := "5") &
	+ (1 * (--> System.Customer.Order) -> (--> System.Customer.Order) => failure) &
	+ ((--> System.Customer.Accept) => failure) &
	+ (((--> System.Customer.Reject) => !System.Customer.Reject) -> [|System.Offer| = 0])
1.0: btl,repeats=5,name="Only two cars of capacity 5",test=
	+ (attempts := "3") &
	+ (capacity := "5") &
	+ [|System.Reject| + |System.Offer| + |System.Accept| < 11] &
	+ (30 * (--> Order) -> (--> Order) => failure) &
	+ (true ---> [|System.Customer.Received_Packages| + |System.Shop.Returns| = 30])
1.0: btl,repeats=5,name="Accept 10 orders in time",test=
	+ (attempts := "3") &
	+ (capacity := "5") &
	+ (System.Shipment := "1`(A,(1,\"Bob\",\"Book\"))@0.0+++1`(A,(2,\"Bob\",\"Book\"))@0.0+++1`(A,(3,\"Bob\",\"Book\"))@0.0+++1`(A,(4,\"Bob\",\"Book\"))@0.0+++1`(A,(5,\"Bob\",\"Book\"))@0.0+++1`(A,(6,\"Bob\",\"Book\"))@0.0+++1`(A,(7,\"Bob\",\"Book\"))@0.0+++1`(A,(8,\"Bob\",\"Book\"))@0.0+++1`(A,(9,\"Bob\",\"Book\"))@0.0+++1`(A,(10,\"Bob\",\"Book\"))@0.0") &
	+ (@(!System.Customer.order & !System.Customer.reject)) &
	+ (10*(--> ([time >= 225 & time <= 255] & [System.Customer.accept]))) &
	+ (--> ([  time = 260 && (|System.Offer| + |System.Reject| + |System.Accept| + |System.Delivery| = 0) ]))
1.0: btl,repeats=5,name="Timeout and partial shipment",test=
	+ (attempts := "3") &
	+ (capacity := "5") &
	+ (System.Shipment := "1`(A,(1,\"Bob\",\"Book\"))@0.0") &
	+ (@(!System.Customer.order & !System.Customer.reject)) &
	+ (--> [|System.Offer| = 0 && time < 3025 && time >= 225]--> [|System.Offer| > 0 && time >= 3025] --> [|System.Offer| = 0 && time > 3035])
1.0: btl,repeats=5,name="Accept 20 orders in time (exact)",test=
	+ (attempts := "3") &
	+ (capacity := "5") &
	+ (System.Shipment := "1`(A,(1,\"Bob\",\"Book\"))@0.0+++1`(A,(2,\"Bob\",\"Book\"))@0.0+++1`(A,(3,\"Bob\",\"Book\"))@0.0+++1`(A,(4,\"Bob\",\"Book\"))@0.0+++1`(A,(5,\"Bob\",\"Book\"))@0.0+++1`(A,(6,\"Bob\",\"Book\"))@0.0+++1`(A,(7,\"Bob\",\"Book\"))@0.0+++1`(A,(8,\"Bob\",\"Book\"))@0.0+++1`(A,(9,\"Bob\",\"Book\"))@0.0+++1`(A,(10,\"Bob\",\"Book\"))@0.0+++1`(A,(11,\"Bob\",\"Book\"))@0.0+++1`(A,(12,\"Bob\",\"Book\"))@0.0+++1`(A,(13,\"Bob\",\"Book\"))@0.0+++1`(A,(14,\"Bob\",\"Book\"))@0.0+++1`(A,(15,\"Bob\",\"Book\"))@0.0+++1`(A,(16,\"Bob\",\"Book\"))@0.0+++1`(A,(17,\"Bob\",\"Book\"))@0.0+++1`(A,(18,\"Bob\",\"Book\"))@0.0+++1`(A,(19,\"Bob\",\"Book\"))@0.0+++1`(A,(20,\"Bob\",\"Book\"))@0.0") &
	+ (@(!System.Customer.order & !System.Customer.reject)) &
	+ (10*(--> ([time >= 225 & time <= 255] & [System.Customer.accept]))) &
	+ (--> ([  time = 255 && (|System.Offer| + |System.Reject| + |System.Accept| + |System.Delivery| = 0) ])) &
	+ (10*(--> ([(time >= 1110 & time <= 1140) | (time >= 1030 & time <= 1060)] & [System.Customer.accept]))) &
	+ (--> ([  (time = 1140 | time = 1060) && (|System.Offer| + |System.Reject| + |System.Accept| + |System.Delivery| = 0) ]))
1.0: btl,repeats=5,name="11 packets delivered: first without timeout, last with",test=
	+ (attempts := "3") &
	+ (capacity := "5") &
	+ (System.Shipment := "1`(A,(1,\"Ann\",\"\"))@0.0+++1`(A,(2,\"Ann\",\"\"))@0.0+++1`(A,(3,\"Ann\",\"\"))@0.0+++1`(A,(4,\"Ann\",\"\"))@0.0+++1`(A,(5,\"Ann\",\"\"))@0.0+++1`(A,(6,\"Ann\",\"\"))@0.0+++1`(A,(7,\"Ann\",\"\"))@0.0+++1`(A,(8,\"Ann\",\"\"))@0.0+++1`(A,(9,\"Ann\",\"\"))@0.0+++1`(A,(10,\"Ann\",\"\"))@0.0+++1`(A,(11,\"Ann\",\"\"))@0.0") &
	+ (@(!System.Customer.order & !System.Customer.reject)) &
	+ (10*(--> ([time >= 225 & time <= 255] & [System.Customer.accept]))) &
	+ (--> ([  time = 255 && (|System.Offer| + |System.Reject| + |System.Accept| + |System.Delivery| = 0) ])) &
	+ (--> ([(time >= 3430 & time <= 3440) | (time >= 3910 & time <= 3920)] & [System.Customer.accept])) &
	+ (--> ([  time = 3440 && (|System.Offer| + |System.Reject| + |System.Accept| + |System.Delivery| = 0) ]))
1.0: btl,repeats=5,name="First reject, then accept (10 Packets), checking pause of car",test=
	+ (attempts := "3") &
	+ (capacity := "5") &
	+ (System.Shipment:="1`(A,(1,\"Ann\",\"\"))@0.0+++1`(A,(2,\"Ann\",\"\"))@0.0+++1`(A,(3,\"Ann\",\"\"))@0.0+++1`(A,(4,\"Ann\",\"\"))@0.0+++1`(A,(5,\"Ann\",\"\"))@0.0+++1`(A,(6,\"Ann\",\"\"))@0.0+++1`(A,(7,\"Ann\",\"\"))@0.0+++1`(A,(8,\"Ann\",\"\"))@0.0+++1`(A,(9,\"Ann\",\"\"))@0.0+++1`(A,(10,\"Ann\",\"\"))@0.0") &
	+ (@(!System.Customer.order)) &
	+ (@((time >= 225 & time <= 255) | !System.Customer.reject)) &
	+ (10*(--> ([time >= 225 & time <= 255] & [System.Customer.Reject]))) &
	+ (@(time > 255 | !System.Customer.accept)) &
	+ (10*(--> ([(time >= 1110 & time <= 1140) | (time >= 1030 & time <= 1060) | (time >= 1590 & time <= 1620)] & [System.Customer.Accept]))) &
	+ (--> ([  (time = 1140 && (|System.Offer| + |System.Reject| + |System.Accept| + |System.Delivery| = 0)) | (time = 1060 && (|System.Offer| + |System.Reject| + |System.Accept| + |System.Delivery| = 0)) | (time = 1620 && (|System.Offer| + |System.Reject| + |System.Accept| + |System.Delivery| = 0)) ]))
